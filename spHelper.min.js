/*
    AUTHOR: Austin Livengood
    DATE: 22 Jul 2021
*/
function spDeleteList(e,t=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var o=t+"/_api/web/lists/GetByTitle('"+e+"')/",n={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose","X-HTTP-Method":"DELETE","If-Match":"*"}),credentials:"include"};fetch(o,n).then(function(e){if(!e.ok)throw new Error("Error");console.log("Response was good!")}).catch(function(e){console.error(e)})}function spDeleteListItem(e,t,o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var n=o+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",r={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose","X-HTTP-Method":"DELETE","If-Match":"*"}),credentials:"include"};fetch(n,r).then(function(e){if(!e.ok)throw new Error("Error!");console.log("Response was good!")}).catch(function(e){console.error(e)})}function spGetCurrentUserId(){var e=_spPageContextInfo.webAbsoluteUrl+"/_api/web/CurrentUser",t={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};fetch(e,t).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(e){return console.log("Success: Current User ID "+e.d.Id+"."),e.d.Id}).catch(function(e){console.error(e)})}function spGetUserById(e,t=_spPageContextInfo.webAbsoluteUrl){var o=t+"/_api/Web/SiteUserInfoList/Items?$filter=Id eq "+e,n={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};fetch(o,n).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(e){return e}).catch(function(e){console.error(e)})}function spGetListItems(e,t="",o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var n=o+"/_api/web/lists/GetByTitle('"+e+"')/items"+t,r={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},s=[];!function e(){fetch(n,r).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(t){if(s=s.concat(t.d.results),!t.d.__next)return s;n=t.d.__next,e()}).catch(function(e){console.error(e)})}()}function spCreateListItem(e,t,o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var n=o+"/_api/lists/GetByTitle('"+e+"')?$select=ListItemEntityTypeFullName",r=o+"/_api/web/lists/GetByTitle('"+e+"')/items",s={method:"GET",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose"}),credentials:"include"};fetch(n,s).then(function(e){if(e.ok)return e.json();throw new Error("Error!")}).then(function(e){var o={__metadata:{type:e.d.ListItemEntityTypeFullName}};for(var n in t)o[n]=t[n];var s={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}),credentials:"include",body:JSON.stringify(o)};return fetch(r,s)}).then(function(e){if(!e.ok)throw new Error("Error!");console.log("Response was good!")}).catch(function(e){console.error(e)})}function spUpdateListItemById(e,t,o,n=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var r=n+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",s=n+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",a={method:"GET",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose"}),credentials:"include"};fetch(r,a).then(function(e){if(e.ok)return e.json();throw new Error("Error!")}).then(function(e){var t={__metadata:{type:e.d.__metadata.type}};for(var n in o)t[n]=o[n];var r={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose","X-HTTP-Method":"MERGE","If-Match":e.d.__metadata.etag}),credentials:"include",body:JSON.stringify(t)};return fetch(s,r)}).then(function(e){if(!e.ok)throw new Error("Error!");console.log("Response was good!")}).catch(function(e){console.error(e)})}function spGetListItemById(e,t,o=_spPageContextInfo.webAbsoluteUrl){var n=o+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",r={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};fetch(n,r).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(e){return e}).catch(function(e){console.error(e)})}function spGetListColumns(e,t=_spPageContextInfo.webAbsoluteUrl){var o=t+"/_api/web/lists/getbytitle('"+e+"')/fields?$select=Title,TypeAsString,TypeDisplayName,Required&$filter=InternalName eq 'Title' and Hidden eq false and ReadOnlyField eq false",n={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},r=[];!function e(){fetch(o,n).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(t){if(r=r.concat(t.d.results),!t.d.__next)return r;o=t.d.__next,e()}).catch(function(e){console.error(e)})}()}function spGetAllLists(e=_spPageContextInfo.webAbsoluteUrl){var t=e+"/_api/web/lists",o={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},n=[];!function e(){fetch(t,o).then(function(e){if(e.ok)return console.log("Response was good!"),e.json();throw new Error("Error!")}).then(function(o){if(n=n.concat(o.d.results),!o.d.__next)return console.log(n),n;t=o.d.__next,e()}).catch(function(e){console.error(e)})}()}function spModalOpen(e,t,o,n,r="url",s=!1,a=!1){var i={allowMaximize:!1,showClose:!0,autoSize:s,width:t,height:o,title:e,dialogReturnValueCallback:function(e){e!=SP.UI.DialogResult.cancel&&a&&SP.UI.ModalDialog.RefreshPage(e)}};i[r]=n,SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}