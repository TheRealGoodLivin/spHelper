/*
    AUTHOR: Austin Livengood | DATE: 22 Jul 2021 | UPDATED: 5 Aug 2021
*/
function spDeleteList(e,t=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var o=t+"/_api/web/lists/GetByTitle('"+e+"')/",r={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose","X-HTTP-Method":"DELETE","If-Match":"*"}),credentials:"include"};return fetch(o,r).then(function(e){if(!e.ok)throw new Error("Error")}).catch(e=>(console.error(e),Promise.reject(e)))}function spDeleteListItem(e,t,o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var r=o+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",n={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose","X-HTTP-Method":"DELETE","If-Match":"*"}),credentials:"include"};return fetch(r,n).then(function(e){if(!e.ok)throw new Error("Error!")}).catch(e=>(console.error(e),Promise.reject(e)))}function spGetCurrentUser(){var e=_spPageContextInfo.webAbsoluteUrl+"/_api/web/CurrentUser/?$expand=groups",t={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};return fetch(e,t).then(e=>e.json()).then(e=>e).catch(e=>(console.error(e),Promise.reject(e)))}function spGetCurrentUserId(){return _spPageContextInfo.userId}function spGetUserById(e,t=_spPageContextInfo.webAbsoluteUrl){var o=t+"/_api/Web/SiteUserInfoList/Items?$filter=Id eq "+e+"&$expand=groups",r={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};return fetch(o,r).then(e=>e.json()).then(e=>e).catch(e=>(console.error(e),Promise.reject(e)))}function spGetListItems(e,t="",o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var r=o+"/_api/web/lists/GetByTitle('"+e+"')/items"+t,n={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},a=[];return function e(){return fetch(r,n).then(e=>e.json()).then(t=>{if(a=a.concat(t.d.results),!t.d.__next)return a;r=t.d.__next,e()}).catch(e=>(console.error(e),Promise.reject(e)))}()}function spCreateListItem(e,t,o=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var r=o+"/_api/lists/GetByTitle('"+e+"')?$select=ListItemEntityTypeFullName",n=o+"/_api/web/lists/GetByTitle('"+e+"')/items",a={method:"GET",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose"}),credentials:"include"};return fetch(r,a).then(e=>e.json()).then(e=>{var o={__metadata:{type:e.d.ListItemEntityTypeFullName}};for(var r in t)o[r]=t[r];var a={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}),credentials:"include",body:JSON.stringify(o)};return fetch(n,a)}).then(function(e){if(!e.ok)throw new Error("Error!")}).catch(e=>(console.error(e),Promise.reject(e)))}function spUpdateListItemById(e,t,o,r=_spPageContextInfo.webAbsoluteUrl){UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval);var n=r+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",a=r+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",s={method:"GET",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose"}),credentials:"include"};return fetch(n,s).then(e=>e.json()).then(e=>{var t={__metadata:{type:e.d.__metadata.type}};for(var r in o)t[r]=o[r];var n={method:"POST",headers:new Headers({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose","X-HTTP-Method":"MERGE","If-Match":e.d.__metadata.etag}),credentials:"include",body:JSON.stringify(t)};return fetch(a,n)}).then(function(e){if(!e.ok)throw new Error("Error!")}).catch(e=>(console.error(e),Promise.reject(e)))}function spGetListItemById(e,t,o=_spPageContextInfo.webAbsoluteUrl){var r=o+"/_api/web/lists/GetByTitle('"+e+"')/items("+t.toString()+")",n={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})};return fetch(r,n).then(e=>e.json()).then(e=>e).catch(e=>(console.error(e),Promise.reject(e)))}function spGetListColumns(e,t=_spPageContextInfo.webAbsoluteUrl){var o=t+"/_api/web/lists/getbytitle('"+e+"')/fields?$select=Title,TypeAsString,TypeDisplayName,Required&$filter=InternalName eq 'Title' and Hidden eq false and ReadOnlyField eq false",r={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},n=[];return function e(){return fetch(o,r).then(e=>e.json()).then(t=>{if(n=n.concat(t.d.results),!t.d.__next)return n;o=t.d.__next,e()}).catch(function(e){return console.error(e),Promise.reject(e)})}()}function spGetAllLists(e=_spPageContextInfo.webAbsoluteUrl){var t=e+"/_api/web/lists",o={method:"GET",headers:new Headers({Accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"})},r=[];return function e(){return fetch(t,o).then(e=>e.json()).then(o=>{if(r=r.concat(o.d.results),!o.d.__next)return r;t=o.d.__next,e()}).catch(e=>(console.error(e),Promise.reject(e)))}()}function spModalOpen(e,t,o,r,n="url",a=!1,s=!1){var i={allowMaximize:!1,showClose:!0,autoSize:a,width:t,height:o,title:e,dialogReturnValueCallback:function(e){e!=SP.UI.DialogResult.cancel&&s&&SP.UI.ModalDialog.RefreshPage(e)}};i[n]=r,SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}